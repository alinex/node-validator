<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for src/type/array.coffee</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">all files</a> / <a href="index.html">src/type/</a> array.coffee
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/156</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/60</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/13</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/100</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js"># Array validator
# =================================================
&nbsp;
# Sanitize options:
#
# - `delimiter` - allow value text with specified list separator
#   (it can also be an regular expression)
#
# Check options:
#
# - `notEmpty` - set to true if an empty array is not valid
# - `minLength` - minimum number of entries
# - `maxLength` - maximum number of entries
# - `toArray` - convert scalar values into array
#
# Validating children:
#
# - `Ã¨ntries` - specification for all entries or as array for each element
&nbsp;
# Node modules
# -------------------------------------------------
<span class="cstat-no" title="statement not covered" >debug = require('debug')('validator:array')</span>
<span class="cstat-no" title="statement not covered" >chalk = require 'chalk'</span>
# alinex modules
<span class="cstat-no" title="statement not covered" >util = require 'alinex-util'</span>
<span class="cstat-no" title="statement not covered" >{string, array} = util</span>
<span class="cstat-no" title="statement not covered" >async = require 'alinex-async'</span>
# include classes and helper
<span class="cstat-no" title="statement not covered" >check = require '../check'</span>
&nbsp;
# Type implementation
# -------------------------------------------------
<span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >exports.describe = (work, cb) -&gt;</span></span>
<span class="cstat-no" title="statement not covered" >  text = 'A list. '</span>
<span class="cstat-no" title="statement not covered" >  text += check.optional.describe work</span>
<span class="cstat-no" title="statement not covered" >  text = text.replace /\. It's/, ' which is'</span>
<span class="cstat-no" title="statement not covered" >  if work.pos.notEmpty</span>
<span class="cstat-no" title="statement not covered" >    text += "It's not allowed to be empty. "</span>
<span class="cstat-no" title="statement not covered" >  if work.pos.delimiter?</span>
<span class="cstat-no" title="statement not covered" >    text += <span class="cstat-no" title="statement not covered" >"You may also give a text or RegExp using '#{<span class="cstat-no" title="statement not covered" >work</span>.pos.delimiter}'</span></span>
      as separator for the individual entries. "
<span class="cstat-no" title="statement not covered" >  if work.pos.unique?</span>
<span class="cstat-no" title="statement not covered" >    text += "All values have to be unique. "</span>
<span class="cstat-no" title="statement not covered" >  if work.pos.minLength? and work.pos.maxLength?</span>
<span class="cstat-no" title="statement not covered" >    text += <span class="cstat-no" title="statement not covered" >"The number of entries have to be between #{<span class="cstat-no" title="statement not covered" >work</span>.pos.minLength}</span></span>
      and #{<span class="cstat-no" title="statement not covered" >work</span>.pos.maxLength}. "
  else <span class="cstat-no" title="statement not covered" >if work.pos.minLength?</span>
<span class="cstat-no" title="statement not covered" >    text += <span class="cstat-no" title="statement not covered" >"At least #{<span class="cstat-no" title="statement not covered" >work</span>.pos.minLength} elements should be given. "</span></span>
  else <span class="cstat-no" title="statement not covered" >if work.pos.maxLength?</span>
<span class="cstat-no" title="statement not covered" >    text += <span class="cstat-no" title="statement not covered" >"Not more than #{<span class="cstat-no" title="statement not covered" >work</span>.pos.maxLength} elements are allowed. "</span></span>
<span class="cstat-no" title="statement not covered" >  async.parallel [</span>
<span class="fstat-no" title="function not covered" >    (cb) -&gt;</span>
<span class="cstat-no" title="statement not covered" ><span class="cstat-no" title="statement not covered" >      return cb()</span> unless work.pos.list?</span>
<span class="cstat-no" title="statement not covered" >      subtext = "The following entries have a specific format:"</span>
<span class="cstat-no" title="statement not covered" >      max = work.pos.list.length - 1</span>
<span class="cstat-no" title="statement not covered" >      async.map [0..max], <span class="fstat-no" title="function not covered" >(num, cb) -&gt;</span></span>
        # run subcheck
<span class="cstat-no" title="statement not covered" >        check.describe work.goInto(['list', num]), <span class="fstat-no" title="function not covered" >(err, text) -&gt;</span></span>
<span class="cstat-no" title="statement not covered" ><span class="cstat-no" title="statement not covered" >          return cb err</span> if err</span>
<span class="cstat-no" title="statement not covered" >          cb null, <span class="cstat-no" title="statement not covered" >"\n- #{<span class="cstat-no" title="statement not covered" >num</span>}: #{<span class="cstat-no" title="statement not covered" >text.replace /\n/g, '\n  '</span>}</span>"</span>
      , <span class="fstat-no" title="function not covered" >(err, results) -&gt;</span>
<span class="cstat-no" title="statement not covered" ><span class="cstat-no" title="statement not covered" >        return cb err</span> if err</span>
<span class="cstat-no" title="statement not covered" >        cb null, subtext + results.join('') + '\n'</span>
<span class="fstat-no" title="function not covered" >    (cb) -&gt;</span>
<span class="cstat-no" title="statement not covered" ><span class="cstat-no" title="statement not covered" >      return cb()</span> unless work.pos.entries?</span>
<span class="cstat-no" title="statement not covered" >      subtext = "And all other entries have to be:\n- "</span>
      # run subcheck
<span class="cstat-no" title="statement not covered" >      check.describe work.goInto(['entries']), <span class="fstat-no" title="function not covered" >(err, text) -&gt;</span></span>
<span class="cstat-no" title="statement not covered" ><span class="cstat-no" title="statement not covered" >        return cb err</span> if err</span>
<span class="cstat-no" title="statement not covered" >        cb null, subtext + (<span class="cstat-no" title="statement not covered" >text.replace /\n/g, '\n  '</span>) + '\n'</span>
  ], <span class="fstat-no" title="function not covered" >(err, results) -&gt;</span>
<span class="cstat-no" title="statement not covered" ><span class="cstat-no" title="statement not covered" >    return cb err</span> if err</span>
<span class="cstat-no" title="statement not covered" >    if work.pos.format?</span>
<span class="cstat-no" title="statement not covered" >      text += <span class="cstat-no" title="statement not covered" >"The value will be formatted as #{<span class="cstat-no" title="statement not covered" >work</span>.pos.format} list. "</span></span>
<span class="cstat-no" title="statement not covered" >    cb null, (<span class="cstat-no" title="statement not covered" >text + results.join ''</span>).trim() + ' '</span>
&nbsp;
<span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >exports.run = (work, cb) -&gt;</span></span>
<span class="cstat-no" title="statement not covered" >  debug "#<span class="cstat-no" title="statement not covered" >{<span class="cstat-no" title="statement not covered" >work</span>.debug} with #{<span class="cstat-no" title="statement not covered" >util.inspect work.value</span>} as #{<span class="cstat-no" title="statement not covered" >work</span>.pos.type}</span>"</span>
<span class="cstat-no" title="statement not covered" >  debug "#<span class="cstat-no" title="statement not covered" >{<span class="cstat-no" title="statement not covered" >work</span>.debug} #{<span class="cstat-no" title="statement not covered" >chalk.grey util.inspect work.pos</span>}</span>"</span>
  # base checks
<span class="cstat-no" title="statement not covered" >  try</span>
<span class="cstat-no" title="statement not covered" >    if check.optional.run work</span>
<span class="cstat-no" title="statement not covered" >      debug "#<span class="cstat-no" title="statement not covered" >{<span class="cstat-no" title="statement not covered" >work</span>.debug} result #{<span class="cstat-no" title="statement not covered" >util.inspect value ? null</span>}</span>"</span>
<span class="cstat-no" title="statement not covered" >      return cb()</span>
  catch error
<span class="cstat-no" title="statement not covered" >    return work.report error, cb</span>
<span class="cstat-no" title="statement not covered" >  value = work.value</span>
  # string to array
<span class="cstat-no" title="statement not covered" >  if typeof value is 'string' and work.pos.delimiter?</span>
<span class="cstat-no" title="statement not covered" >    del = string.toRegExp work.pos.delimiter</span>
<span class="cstat-no" title="statement not covered" >    debug "#<span class="cstat-no" title="statement not covered" >{<span class="cstat-no" title="statement not covered" >work</span>.debug} use delimiter #{<span class="cstat-no" title="statement not covered" >typeof del</span>} #{<span class="cstat-no" title="statement not covered" >util.inspect del</span>}</span>"</span>
<span class="cstat-no" title="statement not covered" >    work.value = value = value.split del</span>
<span class="cstat-no" title="statement not covered" >  if work.pos.toArray and not Array.isArray value</span>
<span class="cstat-no" title="statement not covered" >    work.value = value = [value]</span>
  # is array
<span class="cstat-no" title="statement not covered" >  unless Array.isArray value</span>
<span class="cstat-no" title="statement not covered" >    return work.report (new <span class="cstat-no" title="statement not covered" >Error "The value has to be an array"</span>), cb</span>
<span class="cstat-no" title="statement not covered" >  if work.pos.unique</span>
<span class="cstat-no" title="statement not covered" >    value = array.unique value</span>
  # not empty
<span class="cstat-no" title="statement not covered" >  if work.pos.notEmpty and value.length is 0</span>
<span class="cstat-no" title="statement not covered" >    return work.report (new <span class="cstat-no" title="statement not covered" >Error "An empty array/list is not allowed"</span>), cb</span>
  # min/macLength
<span class="cstat-no" title="statement not covered" >  if work.pos.minLength? and work.pos.minLength is work.pos.maxLength and (</span>
<span class="cstat-no" title="statement not covered" >    value.length isnt work.pos.minLength</span>)
<span class="cstat-no" title="statement not covered" >    return work.report (new <span class="cstat-no" title="statement not covered" >Error <span class="cstat-no" title="statement not covered" >"Exactly #{<span class="cstat-no" title="statement not covered" >work</span>.pos.minLength} entries are required"</span></span>), cb</span>
  else <span class="cstat-no" title="statement not covered" >if work.pos.minLength? and work.pos.minLength &gt; value.length</span>
<span class="cstat-no" title="statement not covered" >    return work.report (new <span class="cstat-no" title="statement not covered" >Error <span class="cstat-no" title="statement not covered" >"At least #{<span class="cstat-no" title="statement not covered" >work</span>.pos.minLength} entries are required as list"</span></span>), cb</span>
  else <span class="cstat-no" title="statement not covered" >if work.pos.maxLength? and work.pos.maxLength &lt; value.length</span>
<span class="cstat-no" title="statement not covered" >    return work.report (new <span class="cstat-no" title="statement not covered" >Error <span class="cstat-no" title="statement not covered" >"Not more than #{<span class="cstat-no" title="statement not covered" >work</span>.pos.maxLength} entries</span></span></span>
    are allowed as list"), cb
  # values
<span class="cstat-no" title="statement not covered" >  unless value.length</span>
    # done return resulting value
<span class="cstat-no" title="statement not covered" >    debug "#<span class="cstat-no" title="statement not covered" >{<span class="cstat-no" title="statement not covered" >work</span>.debug} result #{<span class="cstat-no" title="statement not covered" >util.inspect value ? null</span>}</span>"</span>
<span class="cstat-no" title="statement not covered" >    return cb null, value</span>
<span class="cstat-no" title="statement not covered" >  max = value.length - 1</span>
<span class="cstat-no" title="statement not covered" >  async.map [0..max], <span class="fstat-no" title="function not covered" >(num, cb) -&gt;</span></span>
    # find sub-check
<span class="cstat-no" title="statement not covered" >    if work.pos.list?[num]?</span>
<span class="cstat-no" title="statement not covered" >      sub = work.goInto ['list', num], [num]</span>
    else <span class="cstat-no" title="statement not covered" >if work.pos.entries?</span>
<span class="cstat-no" title="statement not covered" >      sub = work.goInto ['entries'], [num]</span>
    else
<span class="cstat-no" title="statement not covered" >      name = work.spec.name ? 'value'</span>
<span class="cstat-no" title="statement not covered" >      path = work.path.concat num</span>
<span class="cstat-no" title="statement not covered" >      name += <span class="cstat-no" title="statement not covered" >"/#{<span class="cstat-no" title="statement not covered" >path.join '/'</span>}</span>"</span>
<span class="cstat-no" title="statement not covered" >      sub = work.goInto null, [num]</span>
<span class="cstat-no" title="statement not covered" >      sub.spec.schema =</span>
        type: switch
          when Array.isArray value[num]
<span class="cstat-no" title="statement not covered" >            'array'</span>
          when typeof value[num] is 'object'
<span class="cstat-no" title="statement not covered" >            'object'</span>
          else
<span class="cstat-no" title="statement not covered" >            'any'</span>
        optional: true
<span class="cstat-no" title="statement not covered" >      sub.path = []</span>
<span class="cstat-no" title="statement not covered" >      sub.pos = sub.spec.schema</span>
<span class="cstat-no" title="statement not covered" >    check.run sub, cb</span>
  , <span class="fstat-no" title="function not covered" >(err, value) -&gt;</span>
<span class="cstat-no" title="statement not covered" ><span class="cstat-no" title="statement not covered" >    return cb err</span> if err</span>
    # format value
<span class="cstat-no" title="statement not covered" >    if work.pos.format</span>
<span class="cstat-no" title="statement not covered" >      switch work.pos.format</span>
        when 'simple'
<span class="cstat-no" title="statement not covered" >          value = value.join ', '</span>
        when 'pretty'
<span class="cstat-no" title="statement not covered" >          value = value.map(<span class="fstat-no" title="function not covered" >(e) -&gt;</span> <span class="cstat-no" title="statement not covered" >util.inspect e</span>).join ', '</span>
        when 'json'
<span class="cstat-no" title="statement not covered" >          value = JSON.stringify value</span>
    # done return resulting value
<span class="cstat-no" title="statement not covered" >    debug "#<span class="cstat-no" title="statement not covered" >{<span class="cstat-no" title="statement not covered" >work</span>.debug} result #{<span class="cstat-no" title="statement not covered" >util.inspect value ? null</span>}</span>"</span>
<span class="cstat-no" title="statement not covered" >    cb null, value</span>
&nbsp;
<span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" >exports.selfcheck = (schema, cb) -&gt;</span></span>
<span class="cstat-no" title="statement not covered" >  check.run</span>
    schema:
      type: 'object'
      allowedKeys: true
      keys: util.extend util.clone(check.base),
        default:
          type: 'array'
          optional: true
        delimiter:
          type: 'or'
          optional: true
          or: [
            type: 'string'
          ,
            type: 'object'
            instanceOf: RegExp
          ]
        toArray:
          type: 'boolean'
          optional: true
        unique:
          type: 'boolean'
          optional: true
        notEmpty:
          type: 'boolean'
          optional: true
        minLength:
          type: 'integer'
          optional: true
          min: 0
        maxLength:
          type: 'integer'
          optional: true
          min: '&lt;&lt;&lt;minLength&gt;&gt;&gt;'
        list:
          type: 'or'
          optional: true
          or: [
            type: 'object'
          ,
            type: 'array'
          ]
        entries:
          type: 'any'
          optional: true
        format:
          type: 'string'
          values: ['simple', 'pretty', 'json']
    value: schema
  , cb
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Wed Apr 20 2016 22:00:03 GMT+0200 (CEST)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
